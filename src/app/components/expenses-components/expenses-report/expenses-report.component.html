<div class="row">
  <div class="col-1" style="width: 60px;"></div>
  <div class="col-11">
    <div class="container-fluid">
      <div class="container p-3 border border-2 rounded shadow-lg">
        <div class="col d-flex gap-3">
          <div class="col">
            <input (change)="filterDataOnChange()" [(ngModel)]="dateFrom" class="form-control" type="date">
          </div>
          <div class="col">
            <input (change)="filterDataOnChange()" [(ngModel)]="dateTo" class="form-control" type="date">
          </div>
        </div>
        <app-expense-categories-ng-select [(selectedCategories)]="selectedCategories" (selectedCategoriesChange)="onSelectedCategoriesChange()"></app-expense-categories-ng-select>
      </div>
      
    
        
        <div class="row justify-content-center m-1">
          <div class="card">
            <div class="card-body">
              <h4 class="card-title">Gastos del periodo</h4>
              <hr>
              <div class="row">
                <div class="col-12 col-xl-7 d-flex align-items-center justify-content-center">
                  <div class="row justify-content-center text-center align-items-center">
                    <div class="col-6 col-lg-4 col-xxl-3  m-1">
                      <app-expenses-kpi [amount]="amountCommon+amountExtraordinary
                      +amountIndividual-amountNoteCredit" title="Total"></app-expenses-kpi>
                    </div>
                    <div class="col-6 col-lg-4 col-xxl-3   m-1">
                      <app-expenses-kpi [amount]="amountCommon" title="Comunes"></app-expenses-kpi>
                    </div>
                    <div class="col-6 col-lg-4  col-xxl-3   m-1">
                      <app-expenses-kpi [amount]="amountExtraordinary" title="Extraordinarios"></app-expenses-kpi>
                    </div>
                    <div class="col-6 col-lg-4 col-xxl-3    m-1">
                      <app-expenses-kpi [amount]="amountIndividual" title="Individuales"></app-expenses-kpi>
                    </div>
                    <div class="col-6 col-lg-4  col-xxl-3   m-1">
                      <app-expenses-kpi [amount]="amountNoteCredit" title="Nota de Credito"></app-expenses-kpi>
                    </div>
                  </div>
                </div>
                @if (chartExpensesPeriod.data.length>0) {
                  <div class="col-12 col-xl-5 d-flex align-items-center justify-content-center">
                    <google-chart [type]="chartExpensesPeriod.type" [data]="chartExpensesPeriod.data" [options]="chartExpensesPeriod.options"></google-chart>
                  </div>
                }
              </div>
              
            </div>
            
          </div>
        </div>
        @if(lastBillRecord && lastBillRecord.id>0){
          <div class="row justify-content-center m-1 mt-3">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">Ultimo Periodo Facturado</h4>
                <div class="card-subtitle">Desde {{lastBillRecord.start_date | date: 'dd/MM/yyyy'}} Hasta: {{lastBillRecord.end_date | date: 'dd/MM/yyyy'}} </div>
                <hr>
                <div class="row">
                  <div class="col-12 col-xl-7 d-flex align-items-center justify-content-center">
                    <div class="row justify-content-center text-center align-items-center">
                      <div class="col-6 col-lg-4 col-xxl-3  m-1">
                        <app-expenses-kpi [amount]="lastBillCommon+lastBillExtraordinary
                        +lastBillIndividual-lastBillNoteCredit" title="Total"></app-expenses-kpi>
                      </div>
                      <div class="col-6 col-lg-4 col-xxl-3  m-1" >
                        <app-expenses-kpi [amount]="lastBillCommon" title="Comunes"></app-expenses-kpi>
                      </div>
                      <div class="col-6 col-lg-4 col-xxl-3  m-1">
                        <app-expenses-kpi [amount]="lastBillExtraordinary" title="Extraordinarios"></app-expenses-kpi>
                      </div>
                      <div class="col-6 col-lg-4 col-xxl-3  m-1">
                        <app-expenses-kpi [amount]="lastBillIndividual" title="Individuales"></app-expenses-kpi>
                      </div>
                      <div class="col-6 col-lg-4 col-xxl-3  m-1">
                        <app-expenses-kpi [amount]="lastBillNoteCredit" title="Nota de Credito"></app-expenses-kpi>
                      </div>
                      <div class="col-6 col-lg-4 col-xxl-3  m-1">
                        <app-expenses-kpi [amount]="lastBillRecord.fineAmount" title="Multas"></app-expenses-kpi>
                      </div>
                      <div class="col-6 col-lg-4 col-xxl-3  m-1">
                        <app-expenses-kpi [amount]="lastBillRecord.pendingAmount" title="Pendiente"></app-expenses-kpi>
                      </div>
                    </div>
                  </div>
                 @if (chartLastBill.data.length>0) {
                  <div class="col-12 col-xl-5 d-flex align-items-center justify-content-center">
                    <google-chart [type]="chartLastBill.type" [data]="chartLastBill.data" [options]="chartLastBill.options"></google-chart>
                  </div>
                 }
                </div>
                
              </div>
            </div>
          </div>
        }
      
        <div class="row justify-content-center m-1 mt-3">
            <div class="card w-100">
              <div class="card-body">
                <h4 class="card-title">Comparación de Gastos Mensuales entre Años</h4>
                <hr>
                <div class="row" style="width: 100%;">
                  
                    @if (chartCompareYearMonth.data.length>0) {
                      <google-chart [type]="chartCompareYearMonth.type" [columns]="chartCompareYearMonth.columns" 
                      [data]="chartCompareYearMonth.data" [options]="chartCompareYearMonth.options" style="width: 100%; height: 650px;">
                    </google-chart>
                      }

                </div>
                
              </div>
            </div>
          </div>
      </div>
  </div>
  
</div>