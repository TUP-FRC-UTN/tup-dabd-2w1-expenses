<div class="container mt-4">
  <div class="card border">
    <div class="card-body mt-4">
      <h3 class="card-title mb-4">Categorias de Gastos</h3>

      <button
        (click)="showModalToAddCategory()"
        class="btn btn-primary float-end"
      >
        Agregar
      </button>

      <div class="mt-4">
        <table id="myTable" class="table table-striped table-bordered display">
          <thead></thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- Modal -->
      <div
        *ngIf="showModal"
        class="modal"
        id="addModal"
        tabindex="-1"
        role="dialog"
        aria-labelledby="errorModalLabel"
        aria-hidden="true"
      >
        <div class="container mt-4">
          <div class="modal-dialog card border" role="document">
            <div class="modal-content card-body">
              <div class="modal-header card-title mb-4">
                <h5 class="modal-title mb-3">Registrar Categoria de Gasto</h5>
              </div>
              <div class="modal-body mb-3">
                <form #form="ngForm" (ngSubmit)="save(form)">
                  <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                      <label
                        for="categoryName"
                        class="col-form-label label-align"
                        >Nombre de Categoría</label
                      >
                    </div>
                    <div class="col-md-6">
                      <input
                        type="text"
                        name="categoryName"
                        id="categoryName"
                        class="form-control"
                        [(ngModel)]="expenseCategory.description"
                        #category="ngModel"
                        required
                      />
                      <div
                        class="error-message"
                        style="height: 20px; font-size: 0.875rem"
                      >
                        @if (category.touched && category.invalid) {
                        <p class="text-danger m-0">
                          El nombre de categoría es requerido
                        </p>
                        }
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="submit"
                      class="btn btn-danger"
                      (click)="closeModalAdd()"
                    >
                      Cerrar
                    </button>
                    <button
                      type="submit"
                      class="btn btn-success"
                      [disabled]="form.invalid"
                    >
                      Guardar
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal Edit -->
      <div
        #modalEdit
        class="modal"
        id="modalConfirrmationDeleteExpense"
        tabindex="-1"
        role="dialog"
        >
        <div class="container mt-4">
          <div class="modal-dialog card border" role="document">
            <div class="modal-content card-body">
              <div class="modal-header card-title mb-4">
                <h5 class="modal-title mb-3">Editar Categoria de Gasto</h5>
              </div>
              <div class="modal-body mb-3">
                <form #form="ngForm" (ngSubmit)="save(form)">
                  <div class="row align-items-center">
                    <div class="col-auto d-flex align-items-center">
                      <label
                        for="categoryName"
                        class="col-form-label label-align mb-3"
                        >Nombre de Categoría</label
                      >
                    </div>
                    <div class="col-md-6">
                      <input
                        type="text"
                        name="categoryName"
                        id="categoryName"
                        class="form-control"
                        [(ngModel)]="expenseCategory.description"
                        #category="ngModel"
                        required
                      />
                      <div
                        class="error-message"
                        style="height: 20px; font-size: 0.875rem"
                      >
                        @if (category.touched && category.invalid) {
                        <p class="text-danger m-0">
                          El nombre de categoría es requerido
                        </p>
                        }
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="submit"
                      class="btn btn-danger"
                      (click)="closeModal(modalEdit)"
                    >
                      Cerrar
                    </button>
                    <button
                      type="submit"
                      class="btn btn-success"
                      [disabled]="form.invalid"
                      (click)="edit()"
                    >
                      Guardar
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
        <!-- Modal Confirm Delete -->
        <div
          #modalConfirmDelete
          class="modal"
          id="modalConfirrmationDeleteExpense"
          tabindex="-1"
          role="dialog"
          >
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Confirmación</h5>
              </div>
              <div class="modal-body">
                ¿Está seguro de eliminar la categoría?
              </div>
              <div class="modal-footer">
                <button
                  type="button"
                  class="btn btn-secondary"
                  (click)="closeModal(modalConfirmDelete)"
                >
                  Cancelar
                </button>
                <button type="button" class="btn btn-primary" (click)="delete(expenseCategory.id)">Aceptar</button>
              </div>
            </div>
          </div>
        </div>
      
    </div>
  </div>
</div>
